---
// ExperienceItem.astro
const { exp, index } = Astro.props;
---

<article
  data-category={exp.category}
  class="group bg-dark-100 rounded-xl border border-zinc-800 hover:border-primary-400/50 transition-all duration-300 overflow-hidden"
>
  <!-- Header compacto -->
  <div class="px-5 py-4 border-b border-zinc-800/50 bg-dark-100/50">
    <div class="flex flex-wrap items-start justify-between gap-3">
      <div class="flex-1 min-w-0">
        <h3 class="text-lg font-semibold mb-1 group-hover:text-primary-400 transition-colors truncate">
          {exp.titleProject}
        </h3>
        <div class="flex flex-wrap items-center gap-2 text-sm">
          <span class="text-primary-300 font-medium">{exp.role}</span>
          <span class="text-zinc-600">â€¢</span>
          <span class="text-zinc-400 italic">{exp.company}</span>
        </div>
      </div>
      
      <div class="flex flex-wrap items-center gap-2">
        <!-- Badge de categorÃ­a -->
        {exp.category === "fullstack" && (
          <span class="px-2.5 py-1 bg-blue-900/20 text-blue-400 text-xs rounded-md border border-blue-800/30 whitespace-nowrap">
            Full-Stack
          </span>
        )}
        {exp.category === "automation" && (
          <span class="px-2.5 py-1 bg-purple-900/20 text-purple-400 text-xs rounded-md border border-purple-800/30 whitespace-nowrap">
            IA + Auto
          </span>
        )}
        {exp.category === "freelance" && (
          <span class="px-2.5 py-1 bg-green-900/20 text-green-400 text-xs rounded-md border border-green-800/30 whitespace-nowrap">
            Freelance
          </span>
        )}
        
        <!-- PerÃ­odo -->
        <span class="px-2.5 py-1 bg-primary-900/20 text-primary-400 text-xs rounded-md font-medium whitespace-nowrap">
          {exp.periodTotal}
        </span>
      </div>
    </div>
    
    <!-- Fecha debajo en mobile -->
    <p class="text-xs text-zinc-500 mt-2 font-mono">{exp.period}</p>
  </div>

  <!-- Contenido -->
  <div class="px-5 py-4">
    <!-- DescripciÃ³n -->
    <p class="text-zinc-300 text-sm leading-relaxed mb-4">
      {exp.description}
    </p>

    <!-- Badge de impacto (solo para automatizaciones) -->
    {exp.impact && (
      <div class="mb-4 px-3 py-2 bg-gradient-to-r from-primary-900/20 to-transparent border-l-2 border-primary-400 rounded-md">
        <p class="text-xs font-semibold text-primary-300">
          ðŸ“ˆ {exp.impact}
        </p>
      </div>
    )}

    <!-- Features en grid compacto -->
    {exp.features?.length > 0 && (
      <details class="group/details">
        <summary class="cursor-pointer text-xs font-semibold text-zinc-400 uppercase tracking-wider mb-3 flex items-center gap-2 hover:text-primary-400 transition-colors">
          <span>Detalles tÃ©cnicos</span>
          <svg class="w-4 h-4 transition-transform group-open/details:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </summary>
        <ul class="grid gap-2 mt-2">
          {exp.features.slice(0, 5).map((item) => (
            <li class="flex items-start gap-2 text-xs text-zinc-400 leading-relaxed">
              <span class="text-primary-400 mt-0.5 flex-shrink-0">â–¸</span>
              <span>{item}</span>
            </li>
          ))}
          {exp.features.length > 5 && (
            <li class="text-xs text-zinc-500 italic pl-4">
              +{exp.features.length - 5} logros mÃ¡s...
            </li>
          )}
        </ul>
      </details>
    )}
  </div>
</article>